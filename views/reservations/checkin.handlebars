<div class="container mt-5 pt-4">
    <h2 class="text-primary text-center">Online Check-In</h2>
    <p class="text-center">Enter your booking reference and last name.</p>

    <div class="card p-4 bg-dark-subtle mt-3 border border-primary shadow">
        <form id="checkinForm">
            <div class="mb-3">
                <label class="form-label">Booking ID</label>
                <input type="text" name="bookingId" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Last Name</label>
                <input type="text" name="lastName" class="form-control" required>
            </div>

            <button class="btn btn-primary w-100">Check In</button>
        </form>

        <div id="result" class="mt-3"></div>
    </div>
</div>

<script>
document.getElementById("checkinForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const bookingId = e.target.bookingId.value;
    const lastName = e.target.lastName.value;

    const res = await fetch("/reservations/api/checkin", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ bookingId, lastName })
    });

    const data = await res.json();
    const result = document.getElementById("result");

    if (data.error) {
        result.innerHTML = `<div class="alert alert-danger">${data.error}</div>`;
    } else {
        result.innerHTML = `
            <div class="alert alert-success">
                <strong>${data.message}</strong><br>
                Boarding Pass: ${data.boardingPassNumber}<br>
                Seat: ${data.seat}
            </div>
        `;
    }
});
</script>
